<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joo suis mignonne</title>
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@400;700&family=Patrick+Hand&family=Indie+Flower&family=Shadows+Into+Light&family=Caveat:wght@400;600&family=Kalam:wght@300;400&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* 기본 스타일 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Patrick Hand', cursive;
            line-height: 1.6;
            color: #333;
            background: #f8f8f8;
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 30px;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #e0e0e0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .header-content {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            font-family: 'Amatic SC', cursive;
            font-size: 28px;
            font-weight: 700;
            color: #333;
            text-decoration: none;
            letter-spacing: -0.5px;
        }

        /* Hero Section */
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)),
                        url('https://images.unsplash.com/photo-1517409425442-f049007f300c?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.3);
            z-index: 1;
        }

        .hero-content {
            max-width: 500px;
            position: relative;
            z-index: 2;
        }

        .hero-title {
            font-family: 'Roboto', sans-serif;
            font-size: 4.8rem;
            margin-bottom: 15px;
            color: white;
            font-weight: 700;
            letter-spacing: -0.5px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.3s forwards;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .hero-subtitle {
            font-family: 'Kalam', cursive;
            font-size: 1.6rem;
            color: rgba(255,255,255,0.9);
            margin-bottom: 40px;
            font-weight: 400;
            font-style: italic;
            opacity: 0;
            animation: fadeInUp 1s ease 0.6s forwards;
            text-shadow: 0 1px 5px rgba(0,0,0,0.3);
        }

        .hero-divider {
            width: 60px;
            height: 2px;
            background: white;
            margin: 0 auto;
            opacity: 0;
            animation: fadeInUp 1s ease 0.9s forwards;
        }

        /* Main Content */
        .main-content {
            padding: 100px 0;
        }

        /* Scrapbook Entry */
        .diary-entry {
            margin-bottom: 80px;
            background: #fff;
            border: 1px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            border-radius: 10px;
            overflow: hidden;
            padding: 50px 40px;
            min-height: 600px;
        }

        .diary-entry:nth-child(even) {
            background: #fafafa;
        }

        .diary-entry:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.1);
        }

        /* Entry Actions */
        .entry-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .diary-entry:hover .entry-actions {
            opacity: 1;
        }

        .action-btn {
            width: 32px;
            height: 32px;
            border: 2px solid rgba(255,255,255,0.8);
            background: #555;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .action-btn:hover {
            background: #222;
            transform: scale(1.1);
        }

        .action-btn.edit {
            background: #777;
        }

        .action-btn.edit:hover {
            background: #555;
        }

        .action-btn.delete {
            background: #999;
        }

        .action-btn.delete:hover {
            background: #777;
        }

        /* Entry Header */
        .entry-header {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
        }

        .entry-date {
            font-family: 'Roboto', sans-serif;
            font-size: 13px;
            color: #777;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 400;
            background: #eee;
            padding: 8px 16px;
            border-radius: 25px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .entry-title {
            font-family: 'Amatic SC', cursive;
            font-size: 3rem;
            color: #222;
            font-weight: 700;
            margin-bottom: 30px;
            line-height: 1.1;
            letter-spacing: 0.5px;
        }

        .entry-content {
            font-family: 'Indie Flower', cursive;
            color: #555;
            line-height: 1.9;
            font-size: 17px;
            font-weight: 400;
            letter-spacing: 0.3px;
            margin-bottom: 30px;
        }

        /* Scrapbook Canvas */
        .scrapbook-canvas {
            position: relative;
            min-height: 300px;
            background: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            margin: 25px 0;
            padding: 30px;
        }

        .canvas-placeholder {
            text-align: center;
            color: #aaa;
            font-style: italic;
            margin-top: 100px;
            font-family: 'Shadows Into Light', cursive;
            font-size: 20px;
        }

        /* Scrapbook Items */
        .scrapbook-item {
            position: absolute;
            cursor: move;
            border: 2px solid transparent;
            border-radius: 12px;
            transition: all 0.3s ease;
            resize: both;
            overflow: hidden;
            min-width: 50px;
            min-height: 50px;
            padding: 5px;
        }

        .scrapbook-item:hover {
            border-color: #777;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .scrapbook-photo {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            border: 5px solid #fff;
        }
        
        .scrapbook-sticker {
            font-size: 50px;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .scrapbook-text {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            border-radius: 15px;
            font-family: 'Amatic SC', cursive;
            font-size: 24px;
            color: #333;
            max-width: 100%;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            resize: vertical;
            overflow: hidden;
        }

        /* Item Controls */
        .item-controls {
            position: absolute;
            top: -15px;
            right: -15px;
            display: none;
            gap: 5px;
            z-index: 10;
        }

        .scrapbook-item:hover .item-controls {
            display: flex;
        }

        .control-btn {
            width: 28px;
            height: 28px;
            background: #555;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .control-btn.delete {
            background: #999;
        }

        .control-btn:hover {
            transform: scale(1.2);
        }

        /* Review Entry Styles */
        .review-category {
            display: inline-block;
            padding: 10px 20px;
            background: #777;
            color: white;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            font-weight: 400;
            border-radius: 25px;
            margin-bottom: 20px;
            font-family: 'Patrick Hand', cursive;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .review-rating {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
        }

        .stars {
            color: #ffc107;
            font-size: 22px;
        }

        .rating-text {
            color: #777;
            font-family: 'Indie Flower', cursive;
            font-size: 16px;
        }

        /* Create Button */
        .create-btn {
            position: fixed;
            bottom: 40px;
            right: 40px;
            width: 64px;
            height: 64px;
            background: #333;
            border: none;
            color: white;
            font-size: 28px;
            font-weight: 300;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            border-radius: 50%;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            font-family: 'Amatic SC', cursive;
        }

        .create-btn:hover {
            background: #222;
            transform: scale(1.1) rotate(90deg);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            backdrop-filter: blur(15px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #f8f8f8;
            padding: 45px;
            width: 90%;
            max-width: 750px;
            max-height: 85vh;
            overflow-y: auto;
            border: 3px solid #e0e0e0;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-header {
            margin-bottom: 35px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .modal-title {
            font-family: 'Amatic SC', cursive;
            font-size: 2.5rem;
            color: #333;
            font-weight: 700;
            letter-spacing: -0.2px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            font-family: 'Roboto', sans-serif;
            display: block;
            margin-bottom: 10px;
            font-size: 16px;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 16px 18px;
            border: 2px solid #ddd;
            background: #fff;
            font-size: 15px;
            font-family: 'Indie Flower', cursive;
            font-weight: 400;
            transition: all 0.3s ease;
            border-radius: 8px;
            color: #333;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #555;
            box-shadow: 0 0 0 2px rgba(51, 51, 51, 0.1);
        }

        .form-group textarea {
            height: 120px;
            resize: vertical;
        }

        /* Photo Upload */
        .photo-upload {
            border: 3px dashed #ddd;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
            font-family: 'Shadows Into Light', cursive;
            color: #999;
            font-size: 18px;
        }

        .photo-upload:hover {
            border-color: #555;
            background: #f0f0f0;
        }

        .photo-upload input[type="file"] {
            display: none;
        }

        .photo-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
        }

        .photo-preview img {
            width: 90px;
            height: 90px;
            object-fit: cover;
            border-radius: 8px;
            border: 3px solid #eee;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .photo-preview img:hover {
            transform: scale(1.1) rotate(3deg);
        }

        /* Scrapbook Tools */
        .scrapbook-tools {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            padding: 15px;
            background: #fafafa;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .tool-btn {
            padding: 10px 18px;
            border: 1px solid #ccc;
            background: #fff;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 400;
            transition: all 0.3s ease;
            font-family: 'Patrick Hand', cursive;
            color: #555;
        }

        .tool-btn:hover {
            background: #f0f0f0;
            transform: scale(1.05);
            border-color: #999;
        }

        .tool-btn.active {
            background: #333;
            color: white;
            border-color: #333;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            padding-top: 25px;
            border-top: 2px solid #e0e0e0;
        }

        .btn {
            padding: 15px 30px;
            border: 2px solid #ccc;
            background: #fff;
            color: #555;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-radius: 12px;
            font-family: 'Patrick Hand', cursive;
        }

        .btn-primary {
            background: #333;
            color: white;
            border-color: #333;
        }

        .btn:hover {
            background: #f0f0f0;
            transform: scale(1.05);
        }

        .btn-primary:hover {
            background: #222;
            border-color: #222;
        }

        /* Footer */
        footer {
            background: #f8f8f8;
            border-top: 2px solid #e0e0e0;
            padding: 60px 0 40px;
            text-align: center;
        }

        .footer-content {
            color: #999;
            font-size: 14px;
            line-height: 1.8;
            font-weight: 400;
            font-family: 'Shadows Into Light', cursive;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-links a {
            color: #999;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            transition: color 0.3s ease;
            font-family: 'Patrick Hand', cursive;
        }

        .footer-links a:hover {
            color: #333;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 100px;
            right: 40px;
            background: #333;
            color: white;
            padding: 18px 30px;
            font-size: 16px;
            z-index: 3000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            border-radius: 15px;
            font-family: 'Patrick Hand', cursive;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 20px;
            }
            
            .hero-title {
                font-size: 3.5rem;
            }
            
            .diary-entry {
                margin-bottom: 60px;
                padding: 30px 25px;
            }

            .entry-actions {
                opacity: 1;
                top: 10px;
                right: 10px;
            }

            .scrapbook-tools {
                flex-wrap: wrap;
            }

            .modal-content {
                width: 95%;
                padding: 30px 25px;
            }

            .entry-title {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#home" class="logo">Joo suis mignonne</a>
            </div>
        </div>
    </header>

    <section class="hero" id="home">
        <div class="hero-content">
            <h1 class="hero-title">Monochrome Diary</h1>
            <p class="hero-subtitle">La vie ne fait que plaisanter</p>
            <div class="hero-divider"></div>
        </div>
    </section>

    <section class="main-content">
        <div class="container" id="entries-container">
            </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="mailto:hello@example.com">email</a>
                <a href="#">instagram</a>
                <a href="#">youtube</a>
                <a href="#">newsletter</a>
            </div>
            <div class="footer-content">
                © 2024 Joo suis mignonne. all rights reserved.<br>
                주형이의 공간에서 일상의 소중한 순간들을 기록합니다.
            </div>
        </div>
    </footer>

    <button class="create-btn" onclick="openModal('create')">+</button>

    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">새 스크랩북 만들기</h3>
            </div>
            
            <form id="createForm">
                <div class="form-group">
                    <label>type</label>
                    <select id="contentType">
                        <option value="diary">diary</option>
                        <option value="review">review</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>title</label>
                    <input type="text" id="contentTitle" placeholder="제목을 입력하세요">
                </div>
                
                <div class="form-group">
                    <label>content</label>
                    <textarea id="contentBody" placeholder="내용을 입력하세요" rows="4"></textarea>
                </div>

                <div class="form-group">
                    <label>사진 추가</label>
                    <div class="photo-upload" onclick="document.getElementById('photoInput').click()">
                        <input type="file" id="photoInput" multiple accept="image/*" onchange="handlePhotoUpload(event)">
                        <div>📷 클릭하거나 사진을 드래그해서 추가하세요</div>
                        <div class="photo-preview" id="photoPreview"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label>스크랩북 꾸미기</label>
                    <div class="scrapbook-tools">
                        <button type="button" class="tool-btn" onclick="addSticker('🌟')">⭐ 별</button>
                        <button type="button" class="tool-btn" onclick="addSticker('💖')">💖 하트</button>
                        <button type="button" class="tool-btn" onclick="addSticker('🌸')">🌸 꽃</button>
                        <button type="button" class="tool-btn" onclick="addSticker('☀️')">☀️ 태양</button>
                        <button type="button" class="tool-btn" onclick="addSticker('🦋')">🦋 나비</button>
                        <button type="button" class="tool-btn" onclick="addTextBox()">📝 텍스트</button>
                    </div>
                    <div class="scrapbook-canvas" id="scrapbookCanvas">
                        <div class="canvas-placeholder">여기에 사진과 스티커를 자유롭게 배치해보세요!</div>
                    </div>
                </div>
            </form>
            
            <div class="form-actions">
                <button type="button" class="btn" onclick="closeModal()">cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveContent()">save</button>
            </div>
        </div>
    </div>

    <script>
        let entries = [
            {
                id: 1,
                type: 'diary',
                title: 'lazy sunday afternoon ☕',
                content: '좋은 책과 함께하는 여유로운 오후. 카페에서 마신 라떼 한 잔의 여유가 하루를 특별하게 만들어준다. 이런 작은 순간들이 모여서 인생이 되는 것 같아요.',
                date: new Date().toLocaleDateString('ko-KR'),
                scrapbookItems: [
                    { type: 'sticker', content: '☕', x: 60, y: 30, width: 70, height: 70 },
                    { type: 'sticker', content: '📚', x: 220, y: 90, width: 70, height: 70 },
                    { type: 'text', content: 'good vibes only', x: 140, y: 160, width: 200, height: 50 }
                ]
            },
            {
                id: 2,
                type: 'diary',
                title: 'thinking about the future 🤔',
                content: '요즘 미래에 대해 생각할 일이 많다. 내가 정말 원하는 것이 무엇인지, 어떤 사람이 되고 싶은지에 대해 깊게 고민하고 있어요. 답은 쉽게 나오지 않지만, 이런 고민 자체가 성장의 과정이라고 생각해요.',
                date: new Date(Date.now() - 86400000).toLocaleDateString('ko-KR'),
                scrapbookItems: [
                    { type: 'sticker', content: '🤔', x: 80, y: 40, width: 70, height: 70 },
                    { type: 'text', content: 'dreams come true', x: 160, y: 120, width: 200, height: 50 },
                    { type: 'sticker', content: '🦋', x: 240, y: 70, width: 70, height: 70 }
                ]
            },
            {
                id: 3,
                type: 'review',
                title: '작은 것들의 신',
                content: '아룬다티 로이의 섬세한 문체로 그려낸 인도의 풍경이 인상적이었어요. 가족의 비밀과 사회의 모순을 다룬 깊이 있는 소설. 읽는 내내 마음이 아프면서도 아름다운 문장들에 빠져들었습니다.',
                date: new Date(Date.now() - 172800000).toLocaleDateString('ko-KR'),
                scrapbookItems: [
                    { type: 'sticker', content: '📚', x: 100, y: 50, width: 70, height: 70 },
                    { type: 'sticker', content: '🌸', x: 200, y: 30, width: 70, height: 70 },
                    { type: 'text', content: 'beautiful story', x: 130, y: 140, width: 200, height: 50 }
                ]
            }
        ];

        let currentEditId = null;
        let nextId = entries.length + 1;
        let currentScrapbookItems = [];
        let uploadedPhotos = [];

        document.addEventListener('DOMContentLoaded', renderEntries);

        function handlePhotoUpload(event) {
            const files = Array.from(event.target.files);
            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedPhotos.push(e.target.result);
                    updatePhotoPreview();
                    addScrapbookItem({ type: 'photo', content: e.target.result });
                };
                reader.readAsDataURL(file);
            });
        }

        function updatePhotoPreview() {
            const preview = document.getElementById('photoPreview');
            preview.innerHTML = '';
            uploadedPhotos.forEach((photo, index) => {
                const img = document.createElement('img');
                img.src = photo;
                img.onclick = () => addScrapbookItem({ type: 'photo', content: photo });
                preview.appendChild(img);
            });
        }

        function addSticker(emoji) {
            addScrapbookItem({ type: 'sticker', content: emoji, width: 70, height: 70 });
        }

        function addTextBox() {
            const text = prompt('텍스트를 입력하세요:');
            if (text) {
                addScrapbookItem({ type: 'text', content: text, width: 200, height: 50 });
            }
        }

        function addScrapbookItem(item) {
            const canvas = document.getElementById('scrapbookCanvas');
            const rect = canvas.getBoundingClientRect();
            const x = (Math.random() * (rect.width - 150)) + 15;
            const y = (Math.random() * (rect.height - 150)) + 15;
            currentScrapbookItems.push({ ...item, x, y });
            renderScrapbookCanvas();
        }

        function renderScrapbookCanvas(items = currentScrapbookItems, containerId = 'scrapbookCanvas', isModal = true) {
            const canvas = document.getElementById(containerId);
            if (!canvas) return;

            canvas.innerHTML = '';
            const placeholder = document.createElement('div');
            placeholder.className = 'canvas-placeholder';
            placeholder.textContent = isModal ? '여기에 사진과 스티커를 자유롭게 배치해보세요!' : '스크랩북이 비어있습니다';

            if (items.length === 0) {
                canvas.appendChild(placeholder);
            } else {
                items.forEach((item, index) => {
                    const itemEl = document.createElement('div');
                    itemEl.className = 'scrapbook-item';
                    itemEl.style.left = item.x + 'px';
                    itemEl.style.top = item.y + 'px';
                    itemEl.style.width = item.width ? item.width + 'px' : '';
                    itemEl.style.height = item.height ? item.height + 'px' : '';
                    if (isModal) itemEl.style.position = 'absolute';
                    
                    let innerEl;
                    if (item.type === 'photo') {
                        innerEl = document.createElement('img');
                        innerEl.src = item.content;
                        innerEl.className = 'scrapbook-photo';
                    } else if (item.type === 'sticker') {
                        innerEl = document.createElement('div');
                        innerEl.textContent = item.content;
                        innerEl.className = 'scrapbook-sticker';
                        innerEl.style.fontSize = item.width ? item.width * 0.7 + 'px' : '50px';
                    } else if (item.type === 'text') {
                        innerEl = document.createElement('div');
                        innerEl.textContent = item.content;
                        innerEl.className = 'scrapbook-text';
                        innerEl.style.fontSize = item.width ? item.width * 0.12 + 'px' : '24px';
                    }
                    itemEl.appendChild(innerEl);

                    if (isModal) {
                        const controls = document.createElement('div');
                        controls.className = 'item-controls';
                        controls.innerHTML = `<button class="control-btn delete" onclick="removeScrapbookItem(${index})">×</button>`;
                        itemEl.appendChild(controls);
                        makeDraggableAndResizable(itemEl, index);
                    }

                    canvas.appendChild(itemEl);
                });
            }
        }

        function makeDraggableAndResizable(element, index) {
            let isDragging = false;
            let isResizing = false;
            let startX, startY, initialX, initialY, initialWidth, initialHeight;
            let item = currentScrapbookItems[index];

            element.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('control-btn')) return;
                
                startX = e.clientX;
                startY = e.clientY;
                initialX = element.offsetLeft;
                initialY = element.offsetTop;
                initialWidth = element.offsetWidth;
                initialHeight = element.offsetHeight;

                if (e.target.classList.contains('scrapbook-text') || e.target.classList.contains('scrapbook-sticker')) {
                    isResizing = true;
                } else {
                    isDragging = true;
                }
                element.style.zIndex = 1000;

                document.addEventListener('mousemove', dragOrResize);
                document.addEventListener('mouseup', stopDragOrResize);
            });

            function dragOrResize(e) {
                e.preventDefault();
                if (isDragging) {
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    element.style.left = initialX + dx + 'px';
                    element.style.top = initialY + dy + 'px';
                    
                    item.x = initialX + dx;
                    item.y = initialY + dy;
                } else if (isResizing) {
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    let newWidth = initialWidth + dx;
                    let newHeight = initialHeight + dy;

                    if (newWidth > 50 && newHeight > 50) {
                        element.style.width = newWidth + 'px';
                        element.style.height = newHeight + 'px';
                        item.width = newWidth;
                        item.height = newHeight;
                        
                        // 텍스트, 스티커 크기 재조정
                        const innerEl = element.querySelector('.scrapbook-sticker, .scrapbook-text');
                        if (innerEl) {
                            if (innerEl.classList.contains('scrapbook-sticker')) {
                                innerEl.style.fontSize = newWidth * 0.7 + 'px';
                            } else if (innerEl.classList.contains('scrapbook-text')) {
                                innerEl.style.fontSize = newWidth * 0.12 + 'px';
                            }
                        }
                    }
                }
            }

            function stopDragOrResize() {
                isDragging = false;
                isResizing = false;
                element.style.zIndex = 'auto';
                document.removeEventListener('mousemove', dragOrResize);
                document.removeEventListener('mouseup', stopDragOrResize);
            }
        }

        function removeScrapbookItem(index) {
            currentScrapbookItems.splice(index, 1);
            renderScrapbookCanvas();
        }

        function addNewEntry(type, title, content) {
            const newEntry = {
                id: nextId++,
                type: type,
                title: title,
                content: content,
                date: new Date().toLocaleDateString('ko-KR'),
                scrapbookItems: [...currentScrapbookItems]
            };
            
            entries.unshift(newEntry);
            renderEntries();
            showNotification('새 스크랩북이 추가되었습니다! 🎉');
        }

        function deleteEntry(id) {
            if (confirm('정말로 이 글을 삭제하시겠습니까?')) {
                entries = entries.filter(entry => entry.id !== id);
                renderEntries();
                showNotification('글이 삭제되었습니다.');
            }
        }

        function editEntry(id) {
            const entry = entries.find(e => e.id === id);
            if (entry) {
                currentEditId = id;
                currentScrapbookItems = [...(entry.scrapbookItems || [])];
                
                document.getElementById('contentType').value = entry.type;
                document.getElementById('contentTitle').value = entry.title;
                document.getElementById('contentBody').value = entry.content;
                
                renderScrapbookCanvas();
                
                document.querySelector('.modal-title').textContent = '스크랩북 수정하기';
                document.getElementById('modal').style.display = 'block';
            }
        }

        function renderEntries() {
            const container = document.getElementById('entries-container');
            container.innerHTML = '';
            
            entries.forEach(entry => {
                const entryHTML = createEntryHTML(entry);
                container.insertAdjacentHTML('beforeend', entryHTML);
                
                const canvasId = `canvas-${entry.id}`;
                const canvas = document.getElementById(canvasId);
                if (canvas) {
                    renderScrapbookCanvas(entry.scrapbookItems, canvasId, false);
                }
            });
            
            applyScrollAnimations();
        }
        
        function createEntryHTML(entry) {
            const isReview = entry.type === 'review';
            const reviewCategory = isReview ? '<span class="review-category">book review</span>' : '';
            const reviewRating = isReview ? `
                <div class="review-rating">
                    <span class="stars">⭐⭐⭐⭐⭐</span>
                    <span class="rating-text">5/5</span>
                </div>
            ` : '';
            
            return `
                <article class="diary-entry ${isReview ? 'review' : ''}" data-id="${entry.id}">
                    <div class="entry-actions">
                        <button class="action-btn edit" onclick="event.stopPropagation(); editEntry(${entry.id})" title="수정">✏️</button>
                        <button class="action-btn delete" onclick="event.stopPropagation(); deleteEntry(${entry.id})" title="삭제">🗑️</button>
                    </div>
                    
                    <div class="entry-header">
                        <div class="entry-date">${entry.date}</div>
                    </div>
                    
                    ${reviewCategory}
                    <h3 class="entry-title">${entry.title}</h3>
                    ${reviewRating}
                    <div class="entry-content">${entry.content}</div>
                    
                    <div class="scrapbook-canvas" id="canvas-${entry.id}"></div>
                </article>
            `;
        }

        function showNotification(message) {
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateY(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function applyScrollAnimations() {
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                        observer.unobserve(entry.target);
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            document.querySelectorAll('.diary-entry').forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(50px)';
                item.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
                
                setTimeout(() => {
                    observer.observe(item);
                }, index * 100);
            });
        }

        function openModal() {
            currentEditId = null;
            currentScrapbookItems = [];
            uploadedPhotos = [];
            document.getElementById('createForm').reset();
            document.getElementById('photoPreview').innerHTML = '';
            renderScrapbookCanvas();
            document.querySelector('.modal-title').textContent = '새 스크랩북 만들기';
            document.getElementById('modal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.getElementById('createForm').reset();
            currentEditId = null;
            currentScrapbookItems = [];
            uploadedPhotos = [];
            document.getElementById('photoPreview').innerHTML = '';
        }

        function saveContent() {
            const type = document.getElementById('contentType').value;
            const title = document.getElementById('contentTitle').value;
            const content = document.getElementById('contentBody').value;
            
            if (!title.trim() || !content.trim()) {
                alert('제목과 내용을 입력해주세요.');
                return;
            }
            
            if (currentEditId) {
                const entryIndex = entries.findIndex(e => e.id === currentEditId);
                if (entryIndex !== -1) {
                    entries[entryIndex].type = type;
                    entries[entryIndex].title = title;
                    entries[entryIndex].content = content;
                    entries[entryIndex].scrapbookItems = [...currentScrapbookItems];
                    renderEntries();
                    showNotification('스크랩북이 수정되었습니다! ✏️');
                }
            } else {
                addNewEntry(type, title, content);
            }
            
            closeModal();
        }

        window.addEventListener('scroll', function() {
            const header = document.querySelector('header');
            if (window.scrollY > 50) {
                header.style.background = 'rgba(255, 255, 255, 0.98)';
                header.style.backdropFilter = 'blur(10px)';
            } else {
                header.style.background = 'rgba(255, 255, 255, 0.95)';
                header.style.backdropFilter = 'blur(10px)';
            }
        });

        window.addEventListener('click', function(e) {
            const modal = document.getElementById('modal');
            if (e.target === modal) {
                closeModal();
            }
        });

        const photoUploadElement = document.querySelector('.photo-upload');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            photoUploadElement.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            photoUploadElement.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            photoUploadElement.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            photoUploadElement.style.borderColor = '#555';
            photoUploadElement.style.background = '#f0f0f0';
        }

        function unhighlight() {
            photoUploadElement.style.borderColor = '#ddd';
            photoUploadElement.style.background = '#fafafa';
        }

        photoUploadElement.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        uploadedPhotos.push(e.target.result);
                        updatePhotoPreview();
                        addScrapbookItem({ type: 'photo', content: e.target.result, width: 160, height: 160 });
                    };
                    reader.readAsDataURL(file);
                }
            });
        }
    </script>
</body>
</html>